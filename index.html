<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–∑—É—á–µ–Ω–∏–µ –¢—É—Ä–µ—Ü–∫–æ–≥–æ –Ø–∑—ã–∫–∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ –∞–Ω–∏–º–∞—Ü–∏–∏ */
        .card { transition: transform 0.2s; position: relative; }
        .card:hover { transform: translateY(-5px); }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è */
        .delete-btn { 
            opacity: 0; 
            transition: opacity 0.3s, color 0.2s; 
        }
        .card:hover .delete-btn { 
            opacity: 1; 
        }
        
        /* –°–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–∞ */
        .correct { border-color: #10b981 !important; background-color: #f0fdf4 !important; }
        .wrong { border-color: #f43f5e !important; background-color: #fff1f2 !important; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen p-6">

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-4xl font-bold text-indigo-600 mb-2">G√ºnl√ºk T√ºrk√ße</h1>
            <div id="status-badge" class="px-3 py-1 rounded-full text-xs inline-block bg-slate-200 text-slate-600 font-medium">–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏...</div>
        </header>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Å –∑–∞–¥–∞–Ω–∏—è–º–∏ -->
        <div id="learning-app" class="grid grid-cols-1 md:grid-cols-2 gap-6"></div>

        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–ª–æ–≤ -->
        <div class="mt-12 p-8 bg-indigo-900 text-white rounded-3xl shadow-2xl">
            <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
                <span>‚ûï</span> –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <input type="text" id="new-ru" placeholder="–†—É—Å—Å–∫–∏–π (–Ω–∞–ø—Ä. –ö–Ω–∏–≥–∞)" class="p-3 rounded-xl bg-indigo-800 border border-indigo-700 outline-none focus:ring-2 focus:ring-white/20 transition-all">
                <input type="text" id="new-tr" placeholder="–¢—É—Ä–µ—Ü–∫–∏–π (–Ω–∞–ø—Ä. Kitap)" class="p-3 rounded-xl bg-indigo-800 border border-indigo-700 outline-none focus:ring-2 focus:ring-white/20 transition-all">
                <select id="new-type" class="p-3 rounded-xl bg-indigo-800 border border-indigo-700 text-white outline-none">
                    <option value="—Å–ª–æ–≤–æ">–°–ª–æ–≤–æ</option>
                    <option value="—Ñ—Ä–∞–∑–∞">–§—Ä–∞–∑–∞</option>
                </select>
                <button onclick="addNewWord()" class="bg-white text-indigo-900 font-bold py-3 rounded-xl hover:bg-indigo-50 transition-colors shadow-lg">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // –ê–î–†–ï–° –í–ê–®–ï–ì–û –°–ï–†–í–ï–†–ê –ù–ê RENDER
        const API_URL = 'https://turkish-learning-app-swnz.onrender.com';

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        async function fetchDailyTasks() {
            try {
                const response = await fetch(`${API_URL}/get-daily-tasks`);
                if (!response.ok) throw new Error();
                const data = await response.json();
                renderApp(data);
                document.getElementById('status-badge').innerText = '‚óè –û–Ω–ª–∞–π–Ω';
                document.getElementById('status-badge').className = 'px-3 py-1 rounded-full text-xs inline-block bg-green-100 text-green-700';
            } catch (e) {
                document.getElementById('status-badge').innerText = '‚óã –û—Ñ—Ñ–ª–∞–π–Ω (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ä–≤–µ—Ä)';
                document.getElementById('status-badge').className = 'px-3 py-1 rounded-full text-xs inline-block bg-red-100 text-red-700';
            }
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫
        function renderApp(data) {
            const app = document.getElementById('learning-app');
            app.innerHTML = '';
            
            data.forEach(item => {
                const card = document.createElement('div');
                card.className = "bg-white p-6 rounded-2xl shadow-md border-l-4 border-indigo-500 card";
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <span class="px-2 py-1 bg-indigo-50 text-indigo-600 text-[10px] font-black rounded uppercase tracking-wider">${item.type}</span>
                        <div class="flex items-center gap-1">
                            <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å –∫—Ä–µ—Å—Ç–∏–∫–æ–º -->
                            <button onclick="deleteItem(${item.id})" class="delete-btn text-slate-300 hover:text-red-500 p-1 transition-colors" title="–£–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                            </button>
                            <button onclick="speak('${item.tr}')" class="p-1 hover:bg-slate-100 rounded-full transition-colors text-lg" title="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å">üîä</button>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold text-slate-800 mb-4">${item.ru}</h3>
                    <div class="space-y-2">
                        <input type="text" 
                            onkeypress="handleEnter(event, this, '${item.tr}')" 
                            placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–µ–≤–æ–¥..." 
                            class="w-full p-3 bg-slate-50 border-2 border-slate-100 rounded-xl outline-none focus:border-indigo-400 transition-all">
                        <p class="text-[10px] text-slate-400 italic ml-1">${item.hint || ''}</p>
                    </div>
                `;
                app.appendChild(card);
            });
        }

        // –õ–æ–≥–∏–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–∞—Ä–æ–ª—è (Admin Token)
        async function deleteItem(id) {
            const password = prompt("–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —ç—Ç–æ–≥–æ —Å–ª–æ–≤–∞:");
            if (!password) return; // –ï—Å–ª–∏ –Ω–∞–∂–∞–ª–∏ "–û—Ç–º–µ–Ω–∞"

            try {
                const response = await fetch(`${API_URL}/delete-item`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'X-Admin-Token': password 
                    },
                    body: JSON.stringify({ id })
                });

                if (response.ok) {
                    // –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –≤–µ—Ä–Ω—É–ª —É—Å–ø–µ—Ö
                    fetchDailyTasks(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
                } else {
                    const errorData = await response.json();
                    alert("–û—à–∏–±–∫–∞: " + (errorData.detail || "–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω"));
                }
            } catch (e) {
                alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º");
            }
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–æ–¥–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
        function handleEnter(event, input, correctTranslation) {
            if (event.key === 'Enter') {
                const userValue = input.value.trim().toLowerCase();
                const correctValue = correctTranslation.toLowerCase();
                
                if (userValue === correctValue) {
                    input.parentElement.parentElement.classList.add('correct');
                    input.parentElement.parentElement.classList.remove('wrong');
                    speak(correctTranslation);
                } else {
                    input.parentElement.parentElement.classList.add('wrong');
                    input.parentElement.parentElement.classList.remove('correct');
                }
            }
        }

        // –û–∑–≤—É—á–∫–∞ —Ç–µ–∫—Å—Ç–∞
        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'tr-TR';
            window.speechSynthesis.speak(utterance);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞
        async function addNewWord() {
            const ru = document.getElementById('new-ru').value;
            const tr = document.getElementById('new-tr').value;
            const type = document.getElementById('new-type').value;
            
            if(!ru || !tr) return alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è!");

            try {
                const response = await fetch(`${API_URL}/add-to-db`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ru, tr, type })
                });
                
                if(response.ok) {
                    document.getElementById('new-ru').value = '';
                    document.getElementById('new-tr').value = '';
                    fetchDailyTasks();
                }
            } catch (e) {
                alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏");
            }
        }

        window.onload = fetchDailyTasks;
    </script>
</body>
</html>
